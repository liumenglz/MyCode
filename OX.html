<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<title>(o゜▽゜)o☆</title>
<style>
#left {
	position: fixed;
	left: 10px;
	top: 80px;
	height: 100px;
	width: 100px;
	text-align: center;
	font-size: 90px;
	border: 1px solid blue;
}

#right {
	position: fixed;
	left: 10px;
	top: 181px;
	height: 100px;
	width: 100px;
	text-align: center;
	font-size: 90px;
	border: 1px solid blue;
}

#div_2 {
	position: relative;
	top: 20px;
	margin: 0px auto;
	height: 50px;
	width: 50px;
	border: 0px solid black;
}

#div_1 {
	position: relative;
	top: 30px;
	/* padding-top:10px;*/
	border: 0px solid blue;
	text-align: center;
	write: 400px;
	height: 400px;
}

#tab {
	position: relative;
	top: 15px;
	border: 0px solid;
	border-collapse: collapse;
	width: 300px;
	height: 300px;
	margin: 0px auto;
	border: 0px solid;
}

#tab td {
	border: 1px solid black;
	background-color: white;
	text-align: center;
	width: 100px;
	height: 100px;
	font-size: 50px;
}
</style>
<script>
	var arr = new Array("X", "O");
	var num = 0;

	var weight1 = new Array(0, 0, 0, 0, 0, 0, 0, 0, 0);
	var weight2 = new Array(0, 0, 0, 0, 0, 0, 0, 0, 0);
	var weight3 = new Array(0, 0, 0, 0, 0, 0, 0, 0, 0);
	//----鼠标移入移出事件
	function changeOver(e) {
		e.style.backgroundColor = "#eeeeee";
	}

	function changeOut(e) {
		e.style.backgroundColor = "#ffffff";
	}
	//-------每次改写权值------
	function gg() {
		var tds = document.getElementsByClassName("change");
		//初始化权值数组
		for (var i = 0; i < 9; i++) {
			if (tds[i].innerText == "O") {
				weight1[i] = -1;
			} else if (tds[i].innerText == "X") {
				weight1[i] = 1;
			} else {
				weight1[i] = 0;
			}
		}
		for (var i = 0; i < 9; i++) {
			weight2[i] = 0;
			weight3[i] = 0;
		}

		//------
		if (tds[0].innerText.length <= 0) {
			weight2[0] = (weight2[0] < (weight1[1] + weight1[2])) ? (weight1[1] + weight1[2])
					: (weight2[0]);
			weight2[0] = (weight2[0] < (weight1[3] + weight1[6])) ? (weight1[3] + weight1[6])
					: (weight2[0]);
			weight2[0] = (weight2[0] < (weight1[4] + weight1[8])) ? (weight1[4] + weight1[8])
					: (weight2[0]);

			weight3[0] = (weight3[0] > (weight1[1] + weight1[2])) ? (weight1[1] + weight1[2])
					: (weight3[0]);
			weight3[0] = (weight3[0] > (weight1[3] + weight1[6])) ? (weight1[3] + weight1[6])
					: (weight3[0]);
			weight3[0] = (weight3[0] > (weight1[4] + weight1[8])) ? (weight1[4] + weight1[8])
					: (weight3[0]);

		}
		if (tds[1].innerText.length <= 0) {
			weight2[1] = (weight2[1] < (weight1[0] + weight1[2])) ? (weight1[0] + weight1[2])
					: (weight2[1]);
			weight2[1] = (weight2[1] < (weight1[4] + weight1[7])) ? (weight1[4] + weight1[7])
					: (weight2[1]);

			weight3[1] = (weight3[1] > (weight1[0] + weight1[2])) ? (weight1[0] + weight1[2])
					: (weight3[1]);
			weight3[1] = (weight3[1] > (weight1[4] + weight1[7])) ? (weight1[4] + weight1[7])
					: (weight3[1]);
		}
		if (tds[2].innerText.length <= 0) {
			weight2[2] = (weight2[2] < (weight1[0] + weight1[1])) ? (weight1[0] + weight1[1])
					: (weight2[2]);
			weight2[2] = (weight2[2] < (weight1[5] + weight1[8])) ? (weight1[5] + weight1[8])
					: (weight2[2]);
			weight2[2] = (weight2[2] < (weight1[4] + weight1[6])) ? (weight1[4] + weight1[6])
					: (weight2[2]);

			weight3[2] = (weight3[2] > (weight1[0] + weight1[1])) ? (weight1[0] + weight1[1])
					: (weight3[2]);
			weight3[2] = (weight3[2] > (weight1[5] + weight1[8])) ? (weight1[5] + weight1[8])
					: (weight3[2]);
			weight3[2] = (weight3[2] > (weight1[4] + weight1[6])) ? (weight1[4] + weight1[6])
					: (weight3[2]);
		}
		if (tds[3].innerText.length <= 0) {
			weight2[3] = (weight2[3] < (weight1[0] + weight1[6])) ? (weight1[0] + weight1[6])
					: (weight2[3]);
			weight2[3] = (weight2[3] < (weight1[4] + weight1[5])) ? (weight1[4] + weight1[5])
					: (weight2[3]);

			weight3[3] = (weight3[3] > (weight1[0] + weight1[6])) ? (weight1[0] + weight1[6])
					: (weight3[3]);
			weight3[3] = (weight3[3] > (weight1[4] + weight1[5])) ? (weight1[4] + weight1[5])
					: (weight3[3]);
		}
		/*if(tds[4].innerText.length <=0){ 	 }*/
		if (tds[5].innerText.length <= 0) {
			weight2[5] = (weight2[5] < (weight1[2] + weight1[8])) ? (weight1[2] + weight1[8])
					: (weight2[5]);
			weight2[5] = (weight2[5] < (weight1[3] + weight1[4])) ? (weight1[3] + weight1[4])
					: (weight2[5]);

			weight3[5] = (weight3[5] > (weight1[2] + weight1[8])) ? (weight1[2] + weight1[8])
					: (weight3[5]);
			weight3[5] = (weight3[5] > (weight1[3] + weight1[4])) ? (weight1[3] + weight1[4])
					: (weight3[5]);
		}
		if (tds[6].innerText.length <= 0) {
			weight2[6] = (weight2[6] < (weight1[0] + weight1[3])) ? (weight1[0] + weight1[3])
					: (weight2[6]);
			weight2[6] = (weight2[6] < (weight1[2] + weight1[4])) ? (weight1[2] + weight1[4])
					: (weight2[6]);
			weight2[6] = (weight2[6] < (weight1[7] + weight1[8])) ? (weight1[7] + weight1[8])
					: (weight2[6]);

			weight3[6] = (weight3[6] > (weight1[0] + weight1[3])) ? (weight1[0] + weight1[3])
					: (weight3[6]);
			weight3[6] = (weight3[6] > (weight1[2] + weight1[4])) ? (weight1[2] + weight1[4])
					: (weight3[6]);
			weight3[6] = (weight3[6] > (weight1[7] + weight1[8])) ? (weight1[7] + weight1[8])
					: (weight3[6]);
		}
		if (tds[7].innerText.length <= 0) {
			weight2[7] = (weight2[7] < (weight1[1] + weight1[4])) ? (weight1[1] + weight1[4])
					: (weight2[7]);
			weight2[7] = (weight2[7] < (weight1[6] + weight1[8])) ? (weight1[6] + weight1[8])
					: (weight2[7]);

			weight3[7] = (weight3[7] > (weight1[1] + weight1[4])) ? (weight1[1] + weight1[4])
					: (weight3[7]);
			weight3[7] = (weight3[7] > (weight1[6] + weight1[8])) ? (weight1[6] + weight1[8])
					: (weight3[7]);
		}
		if (tds[8].innerText.length <= 0) {
			weight2[8] = (weight2[8] < (weight1[0] + weight1[4])) ? (weight1[0] + weight1[4])
					: (weight2[8]);
			weight2[8] = (weight2[8] < (weight1[2] + weight1[5])) ? (weight1[2] + weight1[5])
					: (weight2[8]);
			weight2[8] = (weight2[8] < (weight1[6] + weight1[7])) ? (weight1[6] + weight1[7])
					: (weight2[8]);

			weight3[8] = (weight3[8] > (weight1[0] + weight1[4])) ? (weight1[0] + weight1[4])
					: (weight3[8]);
			weight3[8] = (weight3[8] > (weight1[2] + weight1[5])) ? (weight1[2] + weight1[5])
					: (weight3[8]);
			weight3[8] = (weight3[8] > (weight1[6] + weight1[7])) ? (weight1[6] + weight1[7])
					: (weight3[8]);
		}

	}
	//----玩家下子
	function cl(f) {
		if (f.innerText.length <= 0) {
			f.innerHTML = arr[0];
			num++;
			gg();
			panduan();

			//---电脑
			if (num != 0) {
				diannao();
				num++;
				panduan();
			}
		}
	}
	//电脑下子
	function diannao() {
		var tds = document.getElementsByClassName("change");
		if (tds[4].innerText.length <= 0) {
			tds[4].innerText = arr[1];
			return 0;
		}

		var n = 0;
		var m = 0;
		var max = 0;
		var min = 0;
		for (var i = 0; i < 9; i++) {
			if (max < weight2[i]) {
				max = weight2[i];
				n = i;
			}
			if (min > weight3[i]) {
				min = weight3[i];
				m = i;
			}
		}

		if(min == -2 && tds[m].innerText.length<=0){
        	tds[m].innerText=arr[1];
        	return 0;
        }
		if(num==3 && max!=2 && tds[1].innerText.length<=0 && tds[4].innerText!='X' && tds[6].innerText=='X'){
			tds[1].innerText=arr[1];
			return 0;
		}
		if(num==3 && max!=2 && tds[5].innerText.length<=0 && tds[4].innerText!='X' && tds[7].innerText=='X' && tds[2].innerText=='X'){
			tds[5].innerText=arr[1];
			return 0;
		}
		if (max == 1 && weight2[1] == 1 && weight2[2] == 1) {
			tds[2].innerText = arr[1];
			return 0;
		}
		if (tds[n].innerText.length <= 0) {
			tds[n].innerText = arr[1];
			return 0;
		}
	}

	//判断是否3连
	function panduan() {
		//每行和每列
		var tds = document.getElementsByClassName("change");
		for (var i = 0; i < 3; i++) {
			var bool = false;
			if (tds[i * 3 + 0].innerText != ""
					|| tds[i * 3 + 1].innerText != ""
					|| tds[i * 3 + 2].innerText != "") {
				bool = true;
			}
			if (tds[i * 3 + 0].innerText == tds[i * 3 + 1].innerText
					&& tds[i * 3 + 0].innerText == tds[i * 3 + 2].innerText
					&& bool) {
				reset(tds[i * 3 + 0].innerText);
				return 0;
			}
			var boo = false;
			if (tds[0 * 3 + i].innerText != ""
					&& tds[1 * 3 + i].innerText != ""
					&& tds[2 * 3 + i].innerText != 0) {
				boo = true;
			}
			if (tds[0 * 3 + i].innerText == tds[1 * 3 + i].innerText
					&& tds[0 * 3 + i].innerText == tds[2 * 3 + i].innerText
					&& boo) {
				reset(tds[0 * 3 + i].innerText);
				return 0;
			}
		}
		//对角线 0 4 8     2 4 6
		if (tds[0].innerText == tds[4].innerText
				&& tds[0].innerText == tds[8].innerText
				&& tds[0].innerText != "" && tds[4].innerText != ""
				&& tds[8].innerText != "") {
			reset(tds[0].innerText);
			return 0;
		}
		if (tds[2].innerText == tds[4].innerText
				&& tds[2].innerText == tds[6].innerText
				&& tds[2].innerText != "" && tds[4].innerText != ""
				&& tds[6].innerText != "") {
			reset(tds[2].innerText);
			return 0;
		}
	}

	//---显示谁赢了
	function reset(x) {
		alert(x + "-----Win!");
		num = 0;
		var tds = document.getElementsByClassName("change");
		for (var i = 0; i < tds.length; i++) {
			tds[i].innerText = "";
			weight1[i] = 0;
			weight2[i] = 0;
		}
	}
	function resets() {
		num = 0;
		var tds = document.getElementsByClassName("change");
		for (var i = 0; i < tds.length; i++) {
			tds[i].innerText = "";
			weight1[i] = 0;
			weight2[i] = 0;
		}
	}
</script>
</head>

<body>
	<div id="div_1">
		<input type="button" onclick="" value="然而却并没有什么用的按钮" />
		<hr />
		<table id="tab">
			<tr>
				<td class="change" onclick="cl(this)" onmouseover="changeOver(this)"
					onmouseout="changeOut(this)"></td>
				<td class="change" onclick="cl(this)" onmouseover="changeOver(this)"
					onmouseout="changeOut(this)"></td>
				<td class="change" onclick="cl(this)" onmouseover="changeOver(this)"
					onmouseout="changeOut(this)"></td>
			</tr>
			<tr>
				<td class="change" onclick="cl(this)" onmouseover="changeOver(this)"
					onmouseout="changeOut(this)"></td>
				<td class="change" onclick="cl(this)" onmouseover="changeOver(this)"
					onmouseout="changeOut(this)"></td>
				<td class="change" onclick="cl(this)" onmouseover="changeOver(this)"
					onmouseout="changeOut(this)"></td>
			</tr>
			<tr>
				<td class="change" onclick="cl(this)" onmouseover="changeOver(this)"
					onmouseout="changeOut(this)"></td>
				<td class="change" onclick="cl(this)" onmouseover="changeOver(this)"
					onmouseout="changeOut(this)"></td>
				<td class="change" onclick="cl(this)" onmouseover="changeOver(this)"
					onmouseout="changeOut(this)"></td>
			</tr>
		</table>
	</div>
	<hr />
	<div id="left">X</div>
	<!-- <div id="right">X</div> -->
	<div id="div_2">
		<input type="button" onclick="resets()" value="重置">
	</div>
</body>
</html>
